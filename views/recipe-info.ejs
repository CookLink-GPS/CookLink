<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Información Receta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon" href="/img/Logo.ico" type="image/x-icon">
</head>

<body class="bg-light">
    <div>
        <%- include("fragments/nav") %>
    </div>
    <div class="container content py-5">
        <div class="row w-100 justify-content-center">
            <div class="col-12 col-md-6">
                <div class="card">
                    <div class="card-body">
                        <% if (!recipe) { %>
                            <div class="alert alert-danger" role="alert">
                                No se encontró la receta.
                            </div>
                            <a href="/recetas/recomendadas" class="btn btn-custom btn-primary">Volver</a>
                            <% } else if (!recipe.nombre) { %>
                                <div class="alert alert-danger" role="alert">
                                    La receta no tiene nombre.
                                </div>
                                <a href="/recetas/recomendadas" class="btn btn-custom btn-primary">Volver</a>
                                <% } else if (!recipe.descripcion) { %>
                                    <div class="alert alert-danger" role="alert">
                                        La receta no tiene descripción.
                                    </div>
                                    <a href="/recetas/recomendadas" class="btn btn-custom btn-primary">Volver</a>
                                    <% } else if (!recipe.ingredients || recipe.ingredients.length===0) { %>
                                        <div class="alert alert-danger" role="alert">
                                            La receta no tiene ingredientes.
                                        </div>
                                        <a href="/recetas/recomendadas" class="btn btn-custom btn-primary">Volver</a>
                                        <% } else { %>
                                            <h4 class="card-title">
                                                <%= recipe.nombre %>
                                            </h4>
                                            <p class="card-text">
                                                <strong>Descripción:</strong>
                                                <%= recipe.descripcion %>
                                            </p>
                                            <p class="card-text">
                                            <h5>Ingredientes:</h5>
                                            <ul>
                                                <% recipe.ingredients.forEach(ingrediente=> { %>
                                                    <li>
                                                        <%= ingrediente.ingrediente %>: <%= ingrediente.unidades %>
                                                                <%= ingrediente.tipoUnidad %>
                                                    </li>
                                                    <% }) %>
                                            </ul>
                                            </p>
                                            <!-- <a href="#" class="btn btn-custom btn-primary">Cocinar</a> -->
                                            <form id="cookForm" action="/recetas/cocinar/<%= recipe.id %>"
                                                method="POST">
                                                <button type="submit" class="btn btn-custom btn-primary">
                                                    Cocinar
                                                </button>
                                            </form>

                                            <a href="/recetas/recomendadas"
                                                class="btn btn-custom btn-primary">Volver</a>
                                            <% } %>
                                                <!-- Modal de éxito -->
                                                <% if (mensajeExito) { %>
                                                    <div class="exitoModal" id="exitoModal">
                                                        <div class="exitoModal-content">
                                                            <div class="exitoModal-header bg-success text-white">
                                                                <h5 class="exitoModal-title" id="exitoModalLabel">
                                                                    ¡Éxito!</h5>
                                                            </div>
                                                            <div class="exitoModal-body">
                                                                <%= mensajeExito %>
                                                            </div>
                                                            <div class="exitoModal-footer">
                                                                <a href="/recetas/recomendaciones"
                                                                    class="btn btn-success">Aceptar</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <% } %>

                                                        <!-- Modal de error -->
                                                        <% if (mensajeError) { %>
                                                            <div class="errorModal" id="errorModal">
                                                                <div class="errorModal-content">
                                                                    <div class="errorModal-header bg-danger text-white">
                                                                        <h5 class="errorModal-title"
                                                                            id="errorModalLabel">¡Error!</h5>
                                                                    </div>
                                                                    <div class="errorModal-body">
                                                                        <%= mensajeError %>
                                                                    </div>
                                                                    <div class="errorModal-footer">
                                                                        <a href="/recetas/recomendaciones"
                                                                            class="btn btn-danger">Aceptar</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <% } %>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <%- include("fragments/footer") %>
    </div>
    <script src="/js/recipeScript.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>